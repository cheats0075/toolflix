

<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>ToolFlix Pro - Oficial</title>

  <style>
    :root {
      --cor-accent: #00ffff;
      --cor-bg-overlay: rgba(0, 0, 0, 0.3);
      --glass-bg: rgba(20, 20, 20, 0.9);
      --glass-border: rgba(255, 255, 255, 0.08);
      --sidebar-width: 280px;
      --admin-panel-bg: rgba(25, 25, 25, 0.98);
    }

    /* --- TEMAS --- */
    body.theme-gow { --cor-accent: #0077ff; background-image: linear-gradient(var(--cor-bg-overlay), var(--cor-bg-overlay)), url('https://cdna.artstation.com/p/assets/covers/images/013/652/970/large/sm-bonin-athena-19.jpg?1540572163') !important; }
    body.theme-dbz { --cor-accent: #ff8c00; background-image: linear-gradient(var(--cor-bg-overlay), var(--cor-bg-overlay)), url('https://wallpaper.dog/large/20399504.jpg') !important; }
    body.theme-mk { --cor-accent: #ff0000; background-image: linear-gradient(var(--cor-bg-overlay), var(--cor-bg-overlay)), url('https://i.redd.it/he010ipc19p51.jpg') !important; }
    body.theme-gta { --cor-accent: #2ecc71; background-image: linear-gradient(var(--cor-bg-overlay), var(--cor-bg-overlay)), url('https://wallpapers.com/images/hd/gta-sa-4k-blonde-girl-z9zaoylvpq1ly51q.jpg') !important; }
    body.theme-gtav { --cor-accent: #fbc531; background-image: linear-gradient(var(--cor-bg-overlay), var(--cor-bg-overlay)), url('https://www.menosfios.com/wp-content/uploads/2013/12/gta5.jpg') !important; }
    body.theme-cod { --cor-accent: #7dff00; background-image: linear-gradient(var(--cor-bg-overlay), var(--cor-bg-overlay)), url('https://images.appspy.com/articles/13784/call-of-duty-mobile.webp') !important; }
    body.theme-re { --cor-accent: #ff0055; background-image: linear-gradient(var(--cor-bg-overlay), var(--cor-bg-overlay)), url('https://t2.tudocdn.net/660435?w=1920') !important; }
    body.theme-cyberPunk { --cor-accent: #ff0055; background-image: linear-gradient(var(--cor-bg-overlay), var(--cor-bg-overlay)), url('https://w0.peakpx.com/wallpaper/641/699/HD-wallpaper-2022-cyberpunk-2077-cyberpunk-2077-2022-games-games-deviantart-cosplay.jpg') !important; }

    body.theme-mario { --cor-accent: #ff0000; background-image: linear-gradient(var(--cor-bg-overlay), var(--cor-bg-overlay)), url('https://image.geekship.com.br/XTVbV7sCcfbpG2E74-cgLhUN4No=/2200x0/smart/filters:strip_icc():format(webp)/hull.geekship.com.br/wp-content/uploads/2023/04/Super-Mario-Bros-O-Filme.jpg'); }
    body.theme-zelda { --cor-accent: #00ff00; background-image: linear-gradient(var(--cor-bg-overlay), var(--cor-bg-overlay)), url('https://images7.alphacoders.com/557/557051.jpg'); }
    body.theme-spiderman { --cor-accent: #ff4500; background-image: linear-gradient(var(--cor-bg-overlay), var(--cor-bg-overlay)), url('https://wallpapercave.com/wp/wp9147243.jpg'); }
    body.theme-fortnite { --cor-accent: #1e90ff; background-image: linear-gradient(var(--cor-bg-overlay), var(--cor-bg-overlay)), url('https://cdn1.epicgames.com/offer/fn/FNECO_39-40_LoveAndLegends_EGS_Launcher_KeyArt_Blade_2560x1440_2560x1440-407af99db5db41f2a0596d35eb57b7d4'); }

    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family:'Segoe UI', system-ui, sans-serif;
      background:#050505;
      color:#f0f0f0;
      display:flex;
      min-height:100vh;
      background-attachment:fixed;
      background-size:cover;
      background-position:center;
      transition:0.5s;
      overflow-x:hidden;
    }

    /* SIDEBAR */
    .sidebar {
      width: var(--sidebar-width);
      height: 100vh;
      background: rgba(5, 5, 5, 0.95);
      backdrop-filter: blur(30px);
      border-right: 1px solid var(--glass-border);
      position: fixed;
      left: 0;
      top: 0;
      display: flex;
      flex-direction: column;
      padding: 25px;
      z-index: 1000;
    }

    #logoToolFlix {
      font-family:'Impact', sans-serif;
      font-size:38px;
      background:linear-gradient(90deg,#fff, var(--cor-accent));
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      margin-bottom: 30px;
      cursor: pointer;
      text-align: center;
      letter-spacing: 2px;
    }

    /* PREMIUM VISUAL */
    body.premium-active #logoToolFlix {
      background: linear-gradient(90deg, #ffd700, #ff8c00, #ffd700);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: logoPulse 1.5s infinite alternate;
      text-shadow: 0 0 5px gold, 0 0 10px orange;
    }

    body.premium-active .sidebar {
      background: linear-gradient(to bottom, rgba(40,40,40,0.85), rgba(25,25,25,0.7));
      backdrop-filter: blur(50px);
      border-right: 1px solid rgba(255,215,0,0.15);
      transition: 0.5s;
    }

    @keyframes logoPulse {
      0% { transform: scale(1); text-shadow: 0 0 5px gold, 0 0 10px orange; }
      50% { transform: scale(1.08); text-shadow: 0 0 15px gold, 0 0 25px orange; }
      100% { transform: scale(1); text-shadow: 0 0 5px gold, 0 0 10px orange; }
    }

    /* CATEGORIAS */
    .catBtn {
      background: rgba(255, 255, 255, 0.05);
      color: #fff;
      padding: 12px 22px;
      border-radius: 50px;
      margin-bottom: 8px;
      font-weight: 500;
      cursor: pointer;
      border: 1px solid rgba(255,255,255,0.1);
      text-align: left;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }
    .catBtn:hover {
      background: linear-gradient(90deg, #00ffff, #00aaff);
      color: #fff;
      transform: translateY(-2px) scale(1.05);
      box-shadow: 0 6px 20px rgba(0,255,255,0.5);
    }
    .catBtn.active {
      background: linear-gradient(90deg, #00ffff, #0080ff);
      color: #000;
      font-weight: 700;
      border: none;
      box-shadow: 0 0 15px rgba(0,255,255,0.6), inset 0 0 8px rgba(255,255,255,0.2);
    }

    /* MAIN */
    main { margin-left: var(--sidebar-width); flex: 1; padding: 30px 50px; width: calc(100% - var(--sidebar-width)); }
    .top-nav { display:flex; justify-content:flex-end; align-items:center; gap:15px; margin-bottom:40px; flex-wrap:wrap; position:relative; z-index: 99999; }
    .nav-item { background: rgba(255,255,255,0.05); border: 1px solid var(--glass-border); color:#fff; padding:12px 20px; border-radius:50px; cursor:pointer; font-weight:600; transition:0.3s; font-size:13px; outline:none; }
    .nav-item:hover { background: rgba(255,255,255,0.15); transform: translateY(-2px); }

    #themeSelect { background:#111; color:gold; border:1px solid gold; padding:10px 18px; border-radius:14px; font-weight:bold; cursor:pointer; }

    /* PREMIUM BTN */
    #premiumTriggerBtn {
      background: linear-gradient(135deg, #ffd700, #ff8c00) !important;
      color: #000 !important;
      border: none !important;
      font-weight: 900 !important;
      box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
      animation: pulsePremium 1.5s infinite ease-in-out, glowPremium 1.5s infinite alternate;
      position: relative;
      overflow: hidden;
    }
    @keyframes pulsePremium { 0% {transform:scale(1)} 50% {transform:scale(1.05)} 100% {transform:scale(1)} }
    @keyframes glowPremium { from { box-shadow: 0 0 5px #ffd700, 0 0 10px #ffd700; } to { box-shadow: 0 0 20px #ffd700, 0 0 30px #ff8c00; } }

    /* CATALOGO */
    #catalogo { display:grid; grid-template-columns: repeat(auto-fill, minmax(190px, 1fr)); gap:25px; position: relative; z-index: 1; }
    .jogo { background: var(--glass-bg); border-radius:20px; padding:15px; border:1px solid var(--glass-border); position:relative; transition: all .4s cubic-bezier(0.175, 0.885, 0.32, 1.275); cursor:pointer; overflow:hidden; z-index:1; }
    .jogo:hover { transform: scale(1.06) translateY(-10px); border-color: var(--cor-accent); box-shadow: 0 15px 35px rgba(0,0,0,0.5), 0 0 15px rgba(0, 255, 255, 0.2); z-index:2; }
    .jogo img { width:100%; border-radius:14px; aspect-ratio:1/1; object-fit:cover; display:block; transition:.4s; background: rgba(255,255,255,0.04); }

    .jogo-premium { border:2px solid gold !important; position:relative; overflow:hidden; animation: premiumGlow 2s infinite alternate; }
    @keyframes premiumGlow { 0% { box-shadow: 0 0 5px gold, 0 0 10px gold; } 50% { box-shadow: 0 0 15px gold, 0 0 25px gold; } 100% { box-shadow: 0 0 5px gold, 0 0 10px gold; } }
    .premium-locked img { filter: grayscale(100%) blur(8px); opacity: 0.2; }

    /* ADMIN */
    #adminSection { display:none; background: var(--admin-panel-bg); padding:30px; border-radius:24px; border: 1px solid var(--cor-accent); margin-bottom: 40px; box-shadow: 0 20px 50px rgba(0,0,0,0.8); animation: slideDown .4s ease; }
    .admin-grid { display:grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap:15px; margin-bottom:25px; }
    .admin-input { background: rgba(255,255,255,0.03); border:1px solid #333; padding:14px; border-radius:12px; color:#fff; font-size:14px; transition:.3s; }

    /* MODAIS / TOAST */
    .modal-overlay { position:fixed; inset:0; background:rgba(0,0,0,0.92); backdrop-filter:blur(15px); display:none; justify-content:center; align-items:center; z-index:9999; }
    .modal-box { background:#111; padding:45px; border-radius:30px; width:400px; text-align:center; border:1px solid #333; }
    #toast-container { position: fixed; bottom: 30px; right: 30px; z-index: 10000; }
    .toast { background:#fff; color:#000; padding:16px 28px; border-radius:14px; margin-top:12px; font-weight:bold; animation: toastIn .3s ease; }

    @keyframes shake { 0%{transform:translateX(0)} 20%{transform:translateX(-4px)} 40%{transform:translateX(4px)} 60%{transform:translateX(-3px)} 80%{transform:translateX(3px)} 100%{transform:translateX(0)} }
    .card-shake { animation: shake 0.35s ease; box-shadow: 0 0 12px rgba(255,0,0,.7); }

    /* PREMIUM BADGE + COUNTER */
    #premiumBadge {
      display:none;
      margin: 10px auto 0;
      width: fit-content;
      padding: 8px 12px;
      border-radius: 999px;
      font-weight: 900;
      font-size: 12px;
      letter-spacing: .6px;
      color: #111;
      background: linear-gradient(90deg, #ffd700, #ffb700, #ffa500);
      box-shadow: 0 0 14px rgba(255,215,0,.35);
      border: 1px solid rgba(255,255,255,.18);
    }
    #premiumCounter {
      margin-top: 10px;
      padding: 12px;
      border-radius: 16px;
      background: rgba(255,255,255,0.04);
      border: 1px solid rgba(255,255,255,0.08);
      font-size: 12px;
      line-height: 1.35;
      opacity: .92;
    }

    /* ===== GAME / XP UI ===== */
    .xpBar{
      width: 160px;
      height: 12px;
      border-radius: 999px;
      background: rgba(255,255,255,0.08);
      border: 1px solid rgba(255,255,255,0.10);
      overflow: hidden;
      box-shadow: inset 0 0 10px rgba(0,0,0,0.35);
    }
    .xpFill{
      height: 100%;
      border-radius: 999px;
      background: linear-gradient(90deg, #00ffff, #ffd700);
      box-shadow: 0 0 12px rgba(0,255,255,0.35);
      transition: width .35s ease;
    }
    .userMenuBox{
      position:absolute;
      top: 44px;
      right: 0;
      width: 170px;
      background: rgba(10,10,10,0.96);
      border: 1px solid rgba(255,255,255,0.10);
      border-radius: 16px;
      padding: 8px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.6);
      backdrop-filter: blur(12px);
      z-index: 100001;
    }
    .userMenuItem{
      width:100%;
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(255,255,255,0.08);
      color:#fff;
      padding: 10px 12px;
      border-radius: 12px;
      cursor:pointer;
      font-weight: 700;
      margin: 6px 0;
    }
    .userMenuItem:hover{ transform: translateY(-1px); background: rgba(255,255,255,0.12); }

    /* deixa a Ã¡rea do usuÃ¡rio sempre escura */
    #userArea {
      background: linear-gradient(145deg, #111, #1a1a1a) !important;
      border: 1px solid rgba(255,255,255,0.1);
      box-shadow: 0 0 10px rgba(0,0,0,0.6);
      border-radius: 50px;
      position: relative;
      z-index: 100000;
    }
    #userArea #xpText { color:#fff; font-weight:600; }
    #userArea .xpBar { background:#000; }

    /* ===== CONQUISTAS ===== */
    .ach-badge {
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,0.10);
      background: rgba(255,255,255,0.04);
      margin: 6px 0;
    }
    .ach-badge.locked { opacity:.55; filter: grayscale(100%); }
    .ach-title { font-weight:900; }
    .ach-meta { font-size:12px; opacity:.85; }
    .ach-progress {
      height:10px;
      border-radius:999px;
      background: rgba(255,255,255,0.08);
      border:1px solid rgba(255,255,255,0.10);
      overflow:hidden;
      margin-top:6px;
    }
    .ach-progress > div{
      height:100%;
      border-radius:999px;
      background: linear-gradient(90deg, #00ffff, #ffd700);
      transition: width .25s ease;
    }

    /* SUPORTE */
    .suporte-container { position: fixed; bottom: 24px; right: 24px; z-index: 9999; }
    .suporte-btn {
      width: 64px; height: 64px; border-radius: 50%;
      border: none; background: linear-gradient(135deg, #ffd700, #ffb700);
      color: #000; font-size: 30px; cursor: pointer;
      box-shadow: 0 0 20px rgba(255, 215, 0, 0.85);
      display:flex; align-items:center; justify-content:center;
      transition: .25s;
    }
    .suporte-btn:hover { transform: scale(1.08); }
    .suporte-painel {
      position:absolute; bottom:78px; right:0; width:300px;
      background: rgba(15, 15, 15, 0.95);
      backdrop-filter: blur(10px);
      border-radius: 18px;
      padding: 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.6);
      display:none;
    }
    .suporte-container.ativo .suporte-painel { display:block; }

    /* Scroll bonito conquistas */
    #achList::-webkit-scrollbar { width: 8px; }
    #achList::-webkit-scrollbar-thumb { background: linear-gradient(180deg, gold, orange); border-radius: 999px; }
    #achList::-webkit-scrollbar-track { background: rgba(255,255,255,0.05); border-radius: 999px; }

    /* Level up fx */
    @keyframes levelPop {
      0% { transform: translateY(0) scale(1); box-shadow: 0 0 0 rgba(255,215,0,0); }
      35% { transform: translateY(-2px) scale(1.06); box-shadow: 0 0 24px rgba(255,215,0,0.35); }
      100% { transform: translateY(0) scale(1); box-shadow: 0 0 0 rgba(255,215,0,0); }
    }
    @keyframes levelRing {
      0% { opacity: 0; transform: scale(0.9); }
      20% { opacity: 1; }
      100% { opacity: 0; transform: scale(1.25); }
    }
    #userArea.level-up-pop {
      animation: levelPop 0.75s ease;
      border-color: rgba(255,215,0,0.55) !important;
    }
    #userArea.level-up-pop::after{
      content:"";
      position:absolute;
      inset:-6px;
      border-radius: 999px;
      border: 2px solid rgba(255,215,0,0.25);
      animation: levelRing 0.75s ease;
      pointer-events:none;
    }
  </style>
</head>

<body class="theme-default">
  <aside class="sidebar">
    <div id="logoToolFlix" onclick="location.reload()">ToolFlix</div>

    <div id="premiumBadge">ğŸ’ PREMIUM ATIVO</div>
    <div id="premiumCounter"></div>

    <div style="margin-bottom:25px">
      <input type="text" id="searchBar" placeholder="ğŸ” Buscar jogos..."
        style="width:100%; padding:14px; border-radius:50px; border:1px solid #222;
        background:rgba(255,255,255,0.04); color:#fff; outline:none;
        font-size:14px; padding-left:20px;">
    </div>

    <nav id="categoriaBtns" style="overflow-y:auto; padding-right:5px;">
      <button class="catBtn active" data-cat="Todos">ğŸ“‚ Todos</button>
      <button class="catBtn" data-cat="Jogos PS2">ğŸ® Jogos PS2</button>
      <button class="catBtn" data-cat="PS2 com Cheats">ğŸ”¥ PS2 Cheats</button>
      <button class="catBtn" data-cat="Jogos PS3">ğŸ® Jogos PS3</button>
      <button class="catBtn" data-cat="PS3 com Cheats">ğŸ”¥ PS3 Cheats</button>
      <button class="catBtn" data-cat="Jogos PS1">ğŸ® Jogos PS1</button>
      <button class="catBtn" data-cat="PS1 com Cheats">ğŸ”¥ PS1 Cheats</button>
      <button class="catBtn" data-cat="YouTube">ğŸ“º YouTube</button>
      <button class="catBtn" data-cat="Jogos PC">ğŸ’» Jogos PC</button>
      <button class="catBtn" data-cat="Fix SteamTools">ğŸ› ï¸ SteamTools</button>
      <button class="catBtn" data-cat="Arquivos">ğŸ—„ï¸ Arquivos</button>
      <button class="catBtn" data-cat="Roms">ğŸ“€ Roms</button>
      <button class="catBtn" data-cat="Emuladores">ğŸ•¹ï¸ Emuladores</button>
    </nav>
  </aside>

  <main>
    <div class="top-nav">
      <select id="themeSelect" class="nav-item">
        <option value="default">ğŸ­ PadrÃ£o</option>
        <option value="gow">God of Warâš”ï¸</option>
        <option value="dbz">Dragon BallğŸ‰</option>
        <option value="mk">ğŸ’ MKğŸ¥·</option>
        <option value="gta">ğŸ’ GTA SAğŸš’</option>
        <option value="gtav">ğŸ’ GTA VğŸš“</option>
        <option value="cod">ğŸ’ CODğŸª–</option>
        <option value="re">ğŸ’ Resident EvilğŸ‘®</option>
        <option value="cyberPunk">ğŸ’ CyberPunkğŸ”«</option>
        <option value="mario">ğŸ’ MarioğŸ„</option>
        <option value="zelda">ğŸ’ ZeldağŸ—¡ï¸</option>
        <option value="spiderman">ğŸ’ SpidermanğŸ•·ï¸</option>
        <option value="fortnite">ğŸ’ FortniteğŸ®</option>
      </select>

      <button class="nav-item" id="sortBtn">ğŸ”ƒ Ordem: Recentes</button>
      <button class="nav-item" id="favFiltroBtn">â¤ï¸ Favoritos</button>
      <button class="nav-item" id="adminBtn">âš™ï¸ Admin</button>

      <!-- ===== ÃREA DO USUÃRIO (GAME) ===== -->
      <div id="userArea" class="nav-item" style="display:flex; align-items:center; gap:10px; position:relative; cursor:pointer;">
        <span id="userNick">Entrar</span>
        <div class="xpBar">
          <div class="xpFill" id="xpFill" style="width:0%"></div>
        </div>
        <span id="xpText">0/100</span>

        <div id="userMenuBox" class="userMenuBox" style="display:none;">
          <button class="userMenuItem" id="openGameBtn">ğŸ® Game</button>
          <button class="userMenuItem" id="openAchBtn">ğŸ† Conquistas</button>
          <button class="userMenuItem" id="logoutBtn">ğŸšª Sair</button>
        </div>
      </div>

      <div style="display:flex; flex-direction:column; gap:8px;">
        <button class="nav-item" id="premiumTriggerBtn">ğŸ’ ATIVAR PREMIUM</button>
        <button class="nav-item" id="solicitarTokenBtn"
          onclick="window.open('https://www.youtube.com/watch?v=FbHaSemn5NI','_blank')"
          style="background:#f1c40f; color:#000; font-size:11px;">
          ğŸ GANHAR TOKEN
        </button>
      </div>
    </div>
    <!-- ===== LOGIN GAME ===== -->
    <div id="userLoginModal" class="modal-overlay">
      <div class="modal-box">
        <h2>ğŸ‘¤ Entrar no Game</h2>
        <input type="text" id="userNickInput" class="admin-input"
          placeholder="Escolha um nickname"
          style="width:100%; margin-top:15px;">
		  <input type="password" id="userPassInput" class="admin-input"
  placeholder="Digite sua senha"
  style="width:100%; margin-top:10px;">
        <button id="userLoginSubmit" class="nav-item"
          style="margin-top:15px; width:100%; background:var(--cor-accent); color:#000;">
          Entrar
        </button>
      </div>
    </div>

    <!-- ===== MODAL GAME ===== -->
    <div id="gameModal" class="modal-overlay">
      <div class="modal-box" style="width:500px; max-width:92vw; text-align:left;">
        <h2 style="color:gold;">ğŸ† Painel Game</h2>
        <div id="gameContent" style="margin-top:15px;"></div>
        <button id="closeGameBtn" class="nav-item" style="margin-top:15px; width:100%;">Fechar</button>
      </div>
    </div>

    <!-- ===== MODAL CONQUISTAS ===== -->
    <div id="achModal" class="modal-overlay">
      <div class="modal-box" style="width:520px; max-width:92vw; text-align:left;">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:14px;">
          <h2 style="color:gold;">ğŸ† Conquistas</h2>
          <button id="closeAchBtn" class="nav-item" style="padding:8px 12px;">âœ–</button>
        </div>
        <div id="achList" style="max-height:60vh; overflow-y:auto; padding-right:8px;"></div>
        <div id="achPlatinum" style="margin-top:15px; font-weight:900; color:gold;"></div>
      </div>
    </div>

    <section id="adminSection"></section>

    <h2 id="sectionTitle" style="margin-bottom:30px; font-size:28px;">Todos</h2>
    <section id="catalogo"></section>
  </main>

  <div id="toast-container"></div>

  <!-- ===== PREMIUM MODAL ===== -->
  <div id="premiumModal" class="modal-overlay">
    <div class="modal-box">
      <h2 style="color:gold; margin-bottom:20px">ğŸ’ Ativar Premium</h2>
      <input type="text" id="premiumInput" maxlength="40" class="admin-input"
        style="width:100%; text-align:center" placeholder="TOKEN">
      <button id="premiumSubmit" class="nav-item"
        style="background:gold; color:#000; width:100%; margin-top:10px">
        Validar
      </button>
    </div>
  </div>

  <div id="premiumWelcomeModal" class="modal-overlay">
    <div class="modal-box" style="border:2px solid gold; background:linear-gradient(145deg,#111,#1a1a1a);">
      <h2 style="color:gold; font-size:28px; margin-bottom:15px;">ğŸ’ Bem-vindo ao Premium</h2>
      <p style="opacity:0.9; margin-bottom:20px;">VocÃª desbloqueou todos os conteÃºdos exclusivos</p>
      <div style="text-align:left; margin-bottom:25px; line-height:1.8; font-size:14px;">
        âœ” Temas exclusivos<br>
        âœ” Jogos Premium<br>
        âœ” ConteÃºdo antecipado
      </div>
      <button id="premiumWelcomeBtn"
        style="background:linear-gradient(135deg,#ffd700,#ff8c00); border:none; color:#000; padding:12px 20px; border-radius:50px; font-weight:700; cursor:pointer; width:100%;">
        ğŸš€ Explorar Agora
      </button>
    </div>
  </div>

  <!-- ===== ADMIN MODAL ===== -->
  <div id="loginModal" class="modal-overlay">
    <div class="modal-box">
      <h2 style="margin-bottom:20px">ğŸ” Admin</h2>
      <input type="password" id="loginInput" class="admin-input"
        style="width:100%" placeholder="Senha">
      <button id="loginSubmit" class="nav-item"
        style="background:var(--cor-accent); color:#000; width:100%; margin-top:10px">
        Entrar
      </button>
    </div>
  </div>

  <!-- SUPORTE -->
  <div class="suporte-container" id="suporteContainer">
    <button class="suporte-btn" id="suporteBtn">ğŸ§</button>
    <div class="suporte-painel">
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
        <strong>ğŸ“¬ Suporte</strong>
        <span style="cursor:pointer; font-size:20px;" id="suporteClose">âœ–</span>
      </div>
      <div style="font-size:13px; opacity:0.85; margin-bottom:12px;">
        <div>â€¢ Pedidos de jogos no YouTube</div>
        <div>â€¢ Informar link off no Discord</div>
        <div>â€¢ Pedir token extra no YouTube</div>
        <div>â€¢ Ajuda para instalar no Telegram</div>
      </div>
      <div style="display:flex; flex-direction:column; gap:8px;">
        <a href="https://t.me/gokugames0" target="_blank">âœˆï¸ Telegram</a>
        <a href="https://discord.com/users/990270059068928011" target="_blank">ğŸ® Discord</a>
        <a href="https://www.youtube.com/watch?v=BB0RbhXJWVc" target="_blank">ğŸ“º YouTube</a>
      </div>
    </div>
  </div>

  <script>
    /* ===============================
     CONFIG / API
  ================================= */

  const API_URL = "https://toolflix-api.onrender.com";
  const URL_JOGOS  = `${API_URL}/api/games`;

  /* ===============================
     HELPERS / NORMALIZAÃ‡ÃƒO
  ================================= */

  function safeStr(v, fallback=""){
    if(v === null || v === undefined) return fallback;
    return String(v);
  }

  function normalizeCategoria(raw){
    const c = safeStr(raw, "").trim();
    if(!c) return "Jogos PS2";
    return c;
  }

  function normalizeGame(g){
    const nome = safeStr(g?.nome ?? g?.title ?? g?.name ?? "Sem nome").trim() || "Sem nome";
    const categoria = normalizeCategoria(g?.categoria ?? g?.category ?? g?.cat);
    const link = safeStr(g?.link ?? g?.url ?? g?.href ?? "").trim();
    const capa = safeStr(g?.capa ?? g?.img ?? g?.image ?? g?.cover ?? "").trim();
    const premium = Boolean(g?.premium === true || g?.isPremium === true || categoria === "Premium");
    return { nome, categoria, link, capa, premium };
  }

  /* ===============================
     STORAGE
  ================================= */

  const LS_JOGOS = 'jogosPS2';
  const LS_FAVS  = 'toolflix_favs';

  let db_jogos = (()=> {
    try{
      const raw = JSON.parse(localStorage.getItem(LS_JOGOS) || '[]');
      return Array.isArray(raw) ? raw.map(normalizeGame) : [];
    }catch{
      return [];
    }
  })();

  let db_favs = (()=> {
    try{
      const raw = JSON.parse(localStorage.getItem(LS_FAVS) || '[]');
      return Array.isArray(raw) ? raw : [];
    }catch{
      return [];
    }
  })();

  let isPremium = false;
  let modoAdmin = false;
  let catAtiva  = 'Todos';
  let sortModo  = 'recentes';
  let filterFav = false;

  /* ===============================
     USER / XP SYSTEM
  ================================= */

  const USER_KEY = 'toolflix_user';
  const USER_ID_KEY = 'toolflix_user_id';
  const API_BASE = 'https://toolflix-api.onrender.com';
const AUTH_KEY = 'toolflix_auth'; // { token, userId, nick }

function loadAuth(){
  try { return JSON.parse(localStorage.getItem(AUTH_KEY)); }
  catch { return null; }
}
function saveAuth(a){
  localStorage.setItem(AUTH_KEY, JSON.stringify(a || null));
}
function clearAuth(){
  localStorage.removeItem(AUTH_KEY);
}

// retorna token ou string vazia
function getToken(){
  const a = loadAuth();
  return a?.token || '';
}

  function getOrCreateUserId(){
    let id = localStorage.getItem(USER_ID_KEY);
    if(!id){
      id = 'u_' + Math.random().toString(36).slice(2,12);
      localStorage.setItem(USER_ID_KEY, id);
    }
    return id;
  }

  function loadUser(){
    try { return JSON.parse(localStorage.getItem(USER_KEY)); }
    catch { return null; }
  }

  function saveUser(u){
    u = u || {};
    u.xp = Number(u.xp || 0);
    localStorage.setItem(USER_KEY, JSON.stringify(u));
  }

  function todayKey(){
    const d = new Date();
    return d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate();
  }

  const XP_RULES = { youtube: 15, download: 10, theme: 15, favorite: 5, premium: 100 };
  const DAILY_KEY = 'toolflix_xp_daily_';
  async function addXp(amount){
  amount = Number(amount || 0);
  if(amount <= 0) return;

  const u = loadUser() || {};
  const token = getToken();

  // se NÃƒO estiver logado â†’ mantÃ©m do jeito antigo (local)
  if(!token){
    u.xp = Number(u.xp || 0) + amount;
    saveUser(u);
    updateUserUI?.();
    return;
  }

  // se estiver logado â†’ soma no servidor e atualiza local com o total oficial
  try{
    const r = await fetch(API_BASE + "/api/add-xp", {
      method: "POST",
      headers: {
        "Content-Type":"application/json",
        "Authorization": "Bearer " + token
      },
      body: JSON.stringify({ amount })
    });
    const j = await r.json();
    if(j?.ok){
      u.xp = Number(j.xp || 0);
      saveUser(u);
      updateUserUI?.();
    }
  }catch{}
}

  function getDaily(){
    try{
      return JSON.parse(localStorage.getItem(DAILY_KEY + todayKey()) || '{"downloads":0,"themes":0,"favorites":0}');
    }catch{
      return {downloads:0,themes:0,favorites:0};
    }
  }

  function setDaily(d){
    localStorage.setItem(DAILY_KEY + todayKey(), JSON.stringify(d));
  }

  function getLevelInfo(totalXp){
    totalXp = Number(totalXp || 0);
    if(totalXp < 100) return {level:1, min:0, max:100};
    if(totalXp < 250) return {level:2, min:100, max:250};
    if(totalXp < 500) return {level:3, min:250, max:500};

    const extra = totalXp - 500;
    const level = 4 + Math.floor(extra / 300);
    const min   = 500 + (level-4)*300;
    const max   = min + 300;
    return {level, min, max};
  }

  function showToast(msg){
    const c = document.getElementById('toast-container');
    if(!c) return;
    const t = document.createElement('div');
    t.className = 'toast';
    t.innerText = msg;
    c.appendChild(t);
    setTimeout(()=>{
      t.style.opacity = '0';
      setTimeout(()=> t.remove(), 300);
    }, 3500);
  }

  function updateUserUI(){
    const u = loadUser();
    const nickEl = document.getElementById('userNick');
    const xpFill = document.getElementById('xpFill');
    const xpText = document.getElementById('xpText');

    if(!u || !u.nick){
      nickEl.innerText = "Entrar";
      xpFill.style.width = "0%";
      xpText.innerText = "0/100";
      return;
    }

    nickEl.innerText = u.nick;
    const info = getLevelInfo(u.xp);
    const pct  = ((u.xp - info.min) / (info.max - info.min)) * 100;

    xpFill.style.width = Math.max(0, Math.min(100, pct)) + "%";
    xpText.innerText   = `${u.xp - info.min}/${info.max - info.min} (Nv ${info.level})`;
  }
    /* ===============================
     AUDIO
  ================================= */

  let TF_AUDIO_CTX = null;

  function tfInitAudio(){
    try{
      if(!TF_AUDIO_CTX){
        TF_AUDIO_CTX = new (window.AudioContext || window.webkitAudioContext)();
      }
      if(TF_AUDIO_CTX.state === 'suspended') TF_AUDIO_CTX.resume();
    }catch(e){}
  }
  window.addEventListener('pointerdown', tfInitAudio, { once:true });

  function playTone(freq, dur=0.09, vol=0.28, type='triangle'){
    try{
      tfInitAudio();
      if(!TF_AUDIO_CTX) return;

      const osc = TF_AUDIO_CTX.createOscillator();
      const gain = TF_AUDIO_CTX.createGain();
      osc.type = type;
      osc.frequency.value = freq;

      const t = TF_AUDIO_CTX.currentTime;
      gain.gain.setValueAtTime(0.0001, t);
      gain.gain.exponentialRampToValueAtTime(vol, t + 0.01);
      gain.gain.exponentialRampToValueAtTime(0.0001, t + dur);

      osc.connect(gain);
      gain.connect(TF_AUDIO_CTX.destination);

      osc.start(t);
      osc.stop(t + dur + 0.02);
    }catch(e){}
  }

  function playTrophySound(){
    playTone(784,  0.08, 0.18, 'triangle');
    setTimeout(()=> playTone(988,  0.08, 0.18, 'triangle'), 90);
    setTimeout(()=> playTone(1175, 0.10, 0.22, 'triangle'), 180);
  }
  function playLevelUpSound(){
    playTone(523, 0.08, 0.16, 'sine');
    setTimeout(()=> playTone(659, 0.08, 0.16, 'sine'), 90);
    setTimeout(()=> playTone(784, 0.09, 0.18, 'sine'), 180);
    setTimeout(()=> playTone(1046,0.11, 0.22, 'sine'), 280);
  }
  window.playTrophySound = playTrophySound;
  window.playLevelUpSound = playLevelUpSound;

  /* ===============================
     XP / LEVEL UP
  ================================= */

  function triggerLevelUpFx(newLevel){
    const el = document.getElementById('userArea');
    if(!el) return;
    el.classList.remove('level-up-pop');
    void el.offsetWidth;
    el.classList.add('level-up-pop');
    setTimeout(()=> el.classList.remove('level-up-pop'), 850);

    playLevelUpSound();
    showToast(`ğŸ‰ UP! VocÃª subiu para o nÃ­vel ${newLevel}!`);
  }

  async function awardXp(amount, reason){
  const u = loadUser();
  if(!u || !u.nick) return;

  amount = Number(amount || 0);
  if(amount <= 0) return;

  const beforeXp = Number(u.xp || 0);
  const beforeLv = getLevelInfo(beforeXp).level;

  // usa a funÃ§Ã£o nova (sincroniza quando logado)
  await addXp(amount);

  // recarrega o usuÃ¡rio apÃ³s atualizar (local foi atualizado dentro do addXp)
  const u2 = loadUser() || u;
  const afterXp = Number(u2.xp || 0);

  showToast(`+${amount} XP (${reason})`);
  updateUserUI();

  const afterLv = getLevelInfo(afterXp).level;
  if(afterLv > beforeLv){
    triggerLevelUpFx(afterLv);
  }
}

  /* ===============================
     USER MENU / LOGIN
  ================================= */

  function openLogin(){
    const m = document.getElementById('userLoginModal');
    const inp = document.getElementById('userNickInput');
    if(m) m.style.display = 'flex';
    if(inp) inp.focus();
  }
  function closeLogin(){
    const m = document.getElementById('userLoginModal');
    if(m) m.style.display = 'none';
  }
  function toggleUserMenu(forceClose=false){
    const box = document.getElementById('userMenuBox');
    if(!box) return;
    if(forceClose){ box.style.display = 'none'; return; }
    box.style.display = (box.style.display === 'block') ? 'none' : 'block';
  }

  document.getElementById('userArea')?.addEventListener('click', ()=>{
    const u = loadUser();
    if(!u || !u.nick) openLogin();
    else toggleUserMenu();
  });

  document.addEventListener('click', (e)=>{
    const box = document.getElementById('userMenuBox');
    const area = document.getElementById('userArea');
    if(!box || !area) return;
    if(!area.contains(e.target) && !box.contains(e.target)) box.style.display = 'none';
  });

  document.getElementById('userLoginSubmit')?.addEventListener('click', async ()=>{
  const nick = (document.getElementById('userNickInput')?.value || '').trim().slice(0,18);
  const pass = (document.getElementById('userPassInput')?.value || '');

  if(!nick){ showToast("Digite um nickname!"); return; }
  if(!pass || pass.length < 6){ showToast("Senha mÃ­nima: 6 caracteres."); return; }

  try{
    const r = await fetch(API_BASE + "/api/login", {
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body: JSON.stringify({ nick, password: pass })
    });

    const j = await r.json();

    if(!j?.ok){
      showToast("Nick ou senha invÃ¡lidos.");
      return;
    }

    // salva token e dados do usuÃ¡rio
    saveAuth({ token: j.token, userId: j.user.id, nick: j.user.nick });
    saveUser({ nick: j.user.nick, xp: Number(j.user.xp || 0) });

    closeLogin();
    toggleUserMenu(true);
    updateUserUI();
    showToast(`Bem-vindo, ${j.user.nick}!`);

  }catch(e){
    showToast("Erro ao conectar com servidor.");
  }
});

  document.getElementById('userNickInput')?.addEventListener('keydown', (e)=>{
    if(e.key === 'Enter'){ e.preventDefault(); document.getElementById('userLoginSubmit')?.click(); }
  });

  document.getElementById('logoutBtn')?.addEventListener('click', ()=>{
    const old = loadUser();
    const keepXp = old ? Number(old.xp || 0) : 0;
    saveUser({ nick: null, xp: keepXp });
    toggleUserMenu(true);
    updateUserUI();
    showToast("VocÃª saiu.");
  });
    /* ===============================
     GAME PANEL
  ================================= */

  const LAST_YT_KEY = 'toolflix_last_youtube_xp';

  function ytCooldownLeft(){
    const last = Number(localStorage.getItem(LAST_YT_KEY) || 0);
    const now = Date.now();
    const cd = 5 * 60 * 1000;
    return Math.max(0, cd - (now - last));
  }

  function fmtTime(ms){
    const s = Math.ceil(ms/1000);
    const m = Math.floor(s/60);
    const r = s % 60;
    return `${m}m ${String(r).padStart(2,'0')}s`;
  }

  function renderGamePanel(){
    const u = loadUser();
    const div = document.getElementById('gameContent');
    if(!div) return;

    if(!u || !u.nick){
      div.innerHTML = "FaÃ§a login para ver suas missÃµes.";
      return;
    }

    const d = getDaily();
    const info = getLevelInfo(u.xp);
    const inLevel = u.xp - info.min;
    const need = info.max - info.min;
    const ytLeft = ytCooldownLeft();

    div.innerHTML = `
      <div style="margin-bottom:15px;">
        <div style="display:flex; justify-content:space-between;">
          <div style="font-weight:900; color:gold;">NÃ­vel ${info.level}</div>
          <div>XP: <b>${inLevel}/${need}</b></div>
        </div>
        <div class="xpBar" style="width:100%; height:14px; margin-top:8px;">
          <div class="xpFill" style="width:${Math.max(0,Math.min(100,(inLevel/need)*100))}%"></div>
        </div>
      </div>

      <div style="font-weight:900; color:gold;">ğŸ”¥ MissÃµes DiÃ¡rias</div>
      <div style="margin-top:10px; font-size:13px; line-height:1.9;">
        <div>ğŸ® Baixar 3 jogos â†’ <b>${d.downloads}/3</b></div>
        <div>â¤ï¸ Favoritar 5 jogos â†’ <b>${d.favorites}/5</b></div>
        <div>ğŸ¨ Trocar tema â†’ <b>${d.themes}/1</b></div>
        <div>ğŸ¥ YouTube â†’ ${ytLeft>0 ? `â³ ${fmtTime(ytLeft)}` : `<span style="color:#8cff8c; font-weight:900;">Pronto</span>`}</div>
      </div>

      <div style="margin-top:15px; font-weight:900; color:gold;">ğŸ’ Especial</div>
      <div style="margin-top:8px;">Virar Premium â†’ 100 XP (Ãºnico)</div>
    `;
  }

  document.getElementById('openGameBtn')?.addEventListener('click', ()=>{
    toggleUserMenu(true);
    document.getElementById('gameModal').style.display = 'flex';
    renderGamePanel();
  });
  document.getElementById('closeGameBtn')?.addEventListener('click', ()=>{
    document.getElementById('gameModal').style.display = 'none';
  });

  setInterval(()=>{
    const m = document.getElementById('gameModal');
    if(m && m.style.display === 'flex') renderGamePanel();
  }, 1000);

  /* ===============================
     CONQUISTAS
  ================================= */

  const ACH_STATS_KEY  = 'toolflix_ach_stats';
  const ACH_UNLOCK_KEY = 'toolflix_ach_unlock';

  const ACH_LIST = [
    { id:'yt_5',   type:'youtube',   title:'ğŸ¥ Aquecimento',        need:5 },
    { id:'yt_15',  type:'youtube',   title:'ğŸ¥ Pegando ritmo',      need:15 },
    { id:'yt_30',  type:'youtube',   title:'ğŸ¥ Maratonista',        need:30 },
    { id:'yt_60',  type:'youtube',   title:'ğŸ¥ Sedento por views',  need:60 },
    { id:'yt_120', type:'youtube',   title:'ğŸ¥ Lenda do YouTube',   need:120 },
    { id:'yt_250', type:'youtube',   title:'ğŸ¥ Insano',             need:250 },

    { id:'dl_3',   type:'downloads', title:'ğŸ® Primeiro download',      need:3 },
    { id:'dl_10',  type:'downloads', title:'ğŸ® ComeÃ§ou a coleÃ§Ã£o',      need:10 },
    { id:'dl_25',  type:'downloads', title:'ğŸ® HD cheio',               need:25 },
    { id:'dl_50',  type:'downloads', title:'ğŸ® Viciado em instalar',    need:50 },
    { id:'dl_100', type:'downloads', title:'ğŸ® Biblioteca braba',       need:100 },
    { id:'dl_200', type:'downloads', title:'ğŸ® Arquivo vivo',           need:200 },

    { id:'fv_5',   type:'favorites', title:'â¤ï¸ CoraÃ§Ã£o de gamer',   need:5 },
    { id:'fv_15',  type:'favorites', title:'â¤ï¸ Curador',            need:15 },
    { id:'fv_30',  type:'favorites', title:'â¤ï¸ Colecionador',       need:30 },
    { id:'fv_60',  type:'favorites', title:'â¤ï¸ SeleÃ§Ã£o de elite',   need:60 },
    { id:'fv_100', type:'favorites', title:'â¤ï¸ Museu ToolFlix',     need:100 },
    { id:'fv_200', type:'favorites', title:'â¤ï¸ Amor infinito',      need:200 },

    { id:'th_1',   type:'themes',    title:'ğŸ¨ Mudou o clima',       need:1 },
    { id:'th_5',   type:'themes',    title:'ğŸ¨ Estiloso',            need:5 },
    { id:'th_15',  type:'themes',    title:'ğŸ¨ CamaleÃ£o',            need:15 },
    { id:'th_30',  type:'themes',    title:'ğŸ¨ Designer',            need:30 },
    { id:'th_60',  type:'themes',    title:'ğŸ¨ Modo DJ',             need:60 },
    { id:'th_120', type:'themes',    title:'ğŸ¨ Multiverso',          need:120 },
  ];

  function achLoadStats(){
    try { return JSON.parse(localStorage.getItem(ACH_STATS_KEY) || '{"youtube":0,"downloads":0,"favorites":0,"themes":0,"premium":0}'); }
    catch { return { youtube:0, downloads:0, favorites:0, themes:0, premium:0 }; }
  }
  function achSaveStats(s){ localStorage.setItem(ACH_STATS_KEY, JSON.stringify(s || {})); }

  function achLoadUnlock(){
    try { return JSON.parse(localStorage.getItem(ACH_UNLOCK_KEY) || '{}'); }
    catch { return {}; }
  }
  function achSaveUnlock(u){ localStorage.setItem(ACH_UNLOCK_KEY, JSON.stringify(u || {})); }

  function achUnlockCheck(){
    const stats = achLoadStats();
    const unlock = achLoadUnlock();
    let changed = false;

    for(const a of ACH_LIST){
      const cur = Number(stats[a.type] || 0);
      if(!unlock[a.id] && cur >= a.need){
        unlock[a.id] = true;
        changed = true;
        showToast(`ğŸ† Conquista desbloqueada: ${a.title}`);
        playTrophySound();
      }
    }

    const allOk = ACH_LIST.every(a => unlock[a.id] === true);
    if(allOk && !unlock['platinum_toolflix']){
      unlock['platinum_toolflix'] = true;
      changed = true;
      showToast('ğŸ† PLATINA TOOLFLIX desbloqueada!');
      playTrophySound();
    }

    if(changed) achSaveUnlock(unlock);
  }

  function achInc(type, amount=1){
    const u = loadUser();
    if(!u || !u.nick) return;

    const stats = achLoadStats();
    stats[type] = Number(stats[type] || 0) + Number(amount || 0);
    achSaveStats(stats);
    achUnlockCheck();
  }

  function achSection(title, items, stats, unlock){
    const lines = items.map(a => {
      const cur = Number(stats[a.type] || 0);
      const done = !!unlock[a.id];
      const prog = Math.min(cur, a.need);
      const pct = Math.max(0, Math.min(100, (prog / a.need) * 100));
      return `
        <div class="ach-badge ${done ? '' : 'locked'}" style="width:100%;">
          <div style="flex:1;">
            <div class="ach-title">${done ? 'âœ…' : 'ğŸ”’'} ${a.title}</div>
            <div class="ach-meta">${done ? 'ConcluÃ­da' : `Progresso: ${prog}/${a.need}`}</div>
            <div class="ach-progress"><div style="width:${pct.toFixed(1)}%"></div></div>
          </div>
        </div>
      `;
    }).join('');

    return `
      <div style="margin-top:14px; font-weight:900; color:gold;">${title}</div>
      <div style="margin-top:8px; display:flex; flex-direction:column; gap:6px;">
        ${lines}
      </div>
    `;
  }

  function achRender(){
    const list = document.getElementById('achList');
    const plat = document.getElementById('achPlatinum');
    if(!list) return;

    const u = loadUser();
    if(!u || !u.nick){
      list.innerHTML = `<div style="opacity:.9">FaÃ§a login para ver suas conquistas.</div>`;
      if(plat) plat.textContent = '';
      return;
    }

    const stats = achLoadStats();
    const unlock = achLoadUnlock();

    const yt = ACH_LIST.filter(a => a.type === 'youtube');
    const dl = ACH_LIST.filter(a => a.type === 'downloads');
    const fv = ACH_LIST.filter(a => a.type === 'favorites');
    const th = ACH_LIST.filter(a => a.type === 'themes');

    list.innerHTML =
      achSection('ğŸ¥ YouTube', yt, stats, unlock) +
      achSection('ğŸ® Downloads', dl, stats, unlock) +
      achSection('â¤ï¸ Favoritos', fv, stats, unlock) +
      achSection('ğŸ¨ Temas', th, stats, unlock);

    if(plat){
      plat.textContent = unlock['platinum_toolflix']
        ? 'ğŸ† PLATINA TOOLFLIX: âœ… Desbloqueada'
        : 'ğŸ† PLATINA TOOLFLIX: â³ Complete todas as conquistas acima';
    }
  }

  document.getElementById('openAchBtn')?.addEventListener('click', ()=>{
    toggleUserMenu(true);
    achRender();
    document.getElementById('achModal').style.display = 'flex';
  });
  document.getElementById('closeAchBtn')?.addEventListener('click', ()=>{
    document.getElementById('achModal').style.display = 'none';
  });

  const _awardXpOriginal = awardXp;
  awardXp = function(amount, reason){
    _awardXpOriginal(amount, reason);
    if(reason === 'YouTube')       achInc('youtube', 1);
    if(reason === 'Download')      achInc('downloads', 1);
    if(reason === 'Favorito')      achInc('favorites', 1);
    if(reason === 'Troca de tema') achInc('themes', 1);
    if(reason === 'Virou Premium') achInc('premium', 1);
  };
    /* ===============================
     PREMIUM (Render only)
  ================================= */

  let premiumMembersCount = 0;

  function getPremiumStats(){
    const totalPremium = db_jogos.filter(j => j && j.premium === true).length;
    const totalItens = db_jogos.length;
    const desbloqueados = (isPremium || modoAdmin) ? totalPremium : 0;
    return { totalPremium, totalItens, desbloqueados };
  }

  function updatePremiumSidebar(){
    const badge = document.getElementById('premiumBadge');
    const counter = document.getElementById('premiumCounter');
    if(!counter) return;

    if(badge) badge.style.display = isPremium ? 'block' : 'none';

    const s = getPremiumStats();
    const headline = isPremium
      ? `ğŸ’ VocÃª Ã© usuÃ¡rio Premium`
      : `ğŸ’ <b>${premiumMembersCount}</b> usuÃ¡rios Premium ativos`;

    counter.innerHTML = `
      <div style="font-weight:900; color:gold; margin-bottom:6px;">${headline}</div>
      <div>ğŸ”“ Desbloqueados: <b>${s.desbloqueados}</b> / <b>${s.totalPremium}</b></div>
      <div>ğŸ“¦ Total no catÃ¡logo: <b>${s.totalItens}</b></div>
    `;
  }

  async function refreshPremiumCount(){
    try{
      const r = await fetch(`${API_URL}/api/total-premium?v=` + Date.now());
      if(!r.ok) throw new Error("TOTAL_PREMIUM_FAIL");
      const data = await r.json();
      premiumMembersCount = Number(data?.totalPremium || 0);
      localStorage.setItem('toolflix_premium_members', String(premiumMembersCount));
    }catch{
      premiumMembersCount = Number(localStorage.getItem('toolflix_premium_members') || 0);
    }
  }

  async function syncPremiumStatus(){
    // userId fixo (nÃ£o depende do nick)
    const userId = getOrCreateUserId();

    // se tiver token salvo, tenta checar no backend se user Ã© premium
    const tokenAtivador = localStorage.getItem('toolflix_token_ativador');
    if(!tokenAtivador){
      isPremium = false;
      localStorage.setItem('toolflix_premium_atv','false');
      return;
    }

    try{
      const r = await fetch(`${API_URL}/api/is-premium/${encodeURIComponent(userId)}?v=` + Date.now());
      if(!r.ok) throw new Error("IS_PREMIUM_FAIL");
      const data = await r.json();
      isPremium = !!data?.premium;
      localStorage.setItem('toolflix_premium_atv', isPremium ? 'true' : 'false');
      if(!isPremium){
        localStorage.removeItem('toolflix_token_ativador');
      }
    }catch{
      isPremium = localStorage.getItem('toolflix_premium_atv') === 'true';
    }
  }

  async function checkPremiumSync(){
    await Promise.all([refreshPremiumCount(), syncPremiumStatus()]);
    updatePremiumSidebar();
    render();
  }

  /* ===============================
     CATALOGO SYNC
  ================================= */

  async function syncJogos(){
    try{
      const resp = await fetch(URL_JOGOS + '?v=' + Date.now());
      if(!resp.ok) return;

      const data = await resp.json();
      const jogosRemotos = Array.isArray(data.games) ? data.games : Array.isArray(data) ? data : [];

      if(jogosRemotos.length === 0){
        console.log("API sem jogos â€” mantendo local.");
        return;
      }

      const normalizados = jogosRemotos.map(normalizeGame);

      const ok = normalizados.some(j => j.nome && j.nome !== "Sem nome");
      if(!ok) return;

      db_jogos = normalizados;
      localStorage.setItem(LS_JOGOS, JSON.stringify(db_jogos));
      render();
    }catch(e){
      console.warn("syncJogos fail:", e);
    }
  }
    /* ===============================
     RENDER
  ================================= */

  function render(){
    const grid = document.getElementById('catalogo');
    if(!grid) return;

    const lg = document.getElementById('logoToolFlix');
    if(isPremium){
      document.body.classList.add('premium-active');
      if(lg) lg.innerText = 'ToolFlix Pro';
    } else {
      document.body.classList.remove('premium-active');
      if(lg) lg.innerText = 'ToolFlix';
    }

    const btnP = document.getElementById('premiumTriggerBtn');
    const btnS = document.getElementById('solicitarTokenBtn');
    if(btnP && btnS){
      btnP.style.display = isPremium ? 'none' : 'block';
      btnS.style.display = isPremium ? 'none' : 'block';
    }

    grid.innerHTML = '';

    let lista = db_jogos.map(normalizeGame);

    if(catAtiva !== 'Todos'){
      lista = lista.filter(j => normalizeCategoria(j.categoria) === catAtiva);
    }

    const search = (document.getElementById('searchBar')?.value || '').toLowerCase();
    if(search){
      lista = lista.filter(j => safeStr(j.nome,'').toLowerCase().includes(search));
    }

    if(filterFav){
      lista = lista.filter(j => db_favs.includes(j.nome));
    }

    if(sortModo === 'az') lista.sort((a,b)=> a.nome.localeCompare(b.nome));
    else if(sortModo === 'za') lista.sort((a,b)=> b.nome.localeCompare(a.nome));
    else if(sortModo === 'recentes') lista.reverse();

    lista.forEach(j => {
      const isFav = db_favs.includes(j.nome);
      const isP = j.premium === true;
      const lock = isP && !isPremium && !modoAdmin;

      const card = document.createElement('div');
      card.className = `jogo ${isP ? 'jogo-premium' : ''} ${lock ? 'premium-locked' : ''}`;

      card.onclick = ()=>{
        if(lock){
          showToast("ğŸ”’ ConteÃºdo Premium!");
          return;
        }

        const link = j.link;
        if(link){
          window.open(link, '_blank');
        }else{
          showToast("Link invÃ¡lido.");
          return;
        }

        const u = loadUser();
        if(!u || !u.nick) return;

        if(j.categoria === 'YouTube'){
          const left = ytCooldownLeft();
          if(left <= 0){
            localStorage.setItem(LAST_YT_KEY, Date.now());
            awardXp(XP_RULES.youtube, "YouTube");
          }else{
            showToast("â³ Aguarde 5 minutos para ganhar XP novamente.");
          }
          return;
        }

        const d = getDaily();
        if(d.downloads < 3){
          d.downloads++;
          setDaily(d);
          awardXp(XP_RULES.download, "Download");
        } else {
          showToast("âš ï¸ Limite diÃ¡rio de downloads atingido.");
        }
      };

      const capaFinal = j.capa || "https://via.placeholder.com/512x512.png?text=ToolFlix";
      const catFinal = normalizeCategoria(j.categoria);

      card.innerHTML = `
        <button onclick="event.stopPropagation(); window.toggleFav('${safeStr(j.nome).replace(/'/g,"\\'")}')"
          style="position:absolute; top:12px; right:12px; background:rgba(0,0,0,0.7);
          color:${isFav?'#ff4757':'#fff'}; border:none; width:34px; height:34px;
          border-radius:50%; cursor:pointer; z-index:10;
          display:flex; align-items:center; justify-content:center; font-size:18px;">
          ${isFav?'â¤ï¸':'ğŸ¤'}
        </button>

        ${lock ? '<span style="position:absolute; top:40%; left:50%; transform:translate(-50%,-50%); font-size:40px; z-index:5">ğŸ”’</span>' : ''}

        <img src="${capaFinal}" alt="" onerror="this.src='https://via.placeholder.com/512x512.png?text=ToolFlix';">

        <div style="margin-top:12px; text-align:center">
          <span style="font-size:10px; color:var(--cor-accent); font-weight:800; letter-spacing:1px">
            ${catFinal}${isP ? ' ğŸ’' : ''}
          </span>
          <p style="font-weight:600; font-size:13px; margin-top:4px;">
            ${safeStr(j.nome,'Sem nome')}
          </p>
        </div>

        ${modoAdmin ? `
          <div style="display:flex; gap:5px; margin-top:10px">
            <button onclick="event.stopPropagation(); window.editJogo('${safeStr(j.nome).replace(/'/g,"\\'")}')"
              style="flex:1; background:gold; color:#000; border:none;
              padding:8px; border-radius:10px; font-weight:bold;
              cursor:pointer; font-size:11px">
              EDITAR
            </button>
            <button onclick="event.stopPropagation(); window.delJogo('${safeStr(j.nome).replace(/'/g,"\\'")}')"
              style="flex:1; background:#ff4757; color:#fff; border:none;
              padding:8px; border-radius:10px;
              cursor:pointer; font-size:11px">
              DELETAR
            </button>
          </div>
        ` : ''}
      `;

      grid.appendChild(card);
    });

    updatePremiumSidebar();
    updateUserUI();
  }

  /* ===============================
     FAVORITOS
  ================================= */

  window.toggleFav = (nome)=>{
    const idx = db_favs.indexOf(nome);

    if(idx > -1){
      db_favs.splice(idx, 1);
      localStorage.setItem(LS_FAVS, JSON.stringify(db_favs));
      render();
      return;
    }

    db_favs.push(nome);
    localStorage.setItem(LS_FAVS, JSON.stringify(db_favs));

    const u = loadUser();
    if(u && u.nick){
      const d = getDaily();
      if(d.favorites < 5){
        d.favorites++;
        setDaily(d);
        awardXp(XP_RULES.favorite, 'Favorito');
      } else {
        showToast("âš ï¸ Limite diÃ¡rio de XP por favoritos (5).");
      }
    }

    render();
  };
    /* ===============================
     BOTÃ•ES UI
  ================================= */

  document.getElementById('sortBtn')?.addEventListener('click', ()=>{
    const modos = ['recentes','az','za'];
    const labels = { recentes:'ğŸ”ƒ Recentes', az:'ğŸ”  A-Z', za:'ğŸ”¡ Z-A' };
    const i = modos.indexOf(sortModo);
    sortModo = modos[(i+1) % modos.length];
    document.getElementById('sortBtn').innerText = 'Ordem: ' + labels[sortModo];
    render();
  });

  document.getElementById('favFiltroBtn')?.addEventListener('click', ()=>{
    filterFav = !filterFav;
    render();
  });

  document.querySelectorAll('.catBtn').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      document.querySelectorAll('.catBtn').forEach(b=> b.classList.remove('active'));
      btn.classList.add('active');
      catAtiva = btn.dataset.cat;
      document.getElementById('sectionTitle').innerText = catAtiva;
      render();
    });
  });

  document.getElementById('searchBar')?.addEventListener('input', render);

  /* ===============================
     TEMA (premium + XP)
  ================================= */

  document.getElementById('themeSelect')?.addEventListener('change', (e)=>{
    const sel = e.target;
    const isTemaPremium = sel.options[sel.selectedIndex].text.includes('ğŸ’');

    if(isTemaPremium && !isPremium && !modoAdmin){
      showToast("ğŸ”’ Apenas usuÃ¡rios Premium!");
      sel.classList.add('card-shake');
      setTimeout(()=> sel.classList.remove('card-shake'), 400);
      sel.value = 'default';
      return;
    }

    document.body.classList.forEach(cls=>{
      if(cls.startsWith('theme-')) document.body.classList.remove(cls);
    });
    document.body.classList.add('theme-' + sel.value);

    const u = loadUser();
    if(u && u.nick){
      const d = getDaily();
      if(d.themes < 1){
        d.themes++;
        setDaily(d);
        awardXp(XP_RULES.theme, 'Troca de tema');
      } else {
        showToast("âš ï¸ XP de tema jÃ¡ foi ganho hoje.");
      }
    }
  });

  /* ===============================
     PREMIUM UI (Render)
  ================================= */

  document.getElementById('premiumTriggerBtn')?.addEventListener('click', ()=>{
    document.getElementById('premiumModal').style.display = 'flex';
    document.getElementById('premiumInput')?.focus();
  });

  document.getElementById('premiumWelcomeBtn')?.addEventListener('click', ()=>{
    document.getElementById('premiumWelcomeModal').style.display = 'none';
  });

  document.getElementById('premiumSubmit')?.addEventListener('click', async ()=>{
    const token = (document.getElementById('premiumInput')?.value || '')
      .toUpperCase().trim().replace(/\s+/g,'');

    if(!token) return showToast("Digite o TOKEN!");

    const userId = getOrCreateUserId();

    try{
      const r = await fetch(`${API_URL}/api/validar-token`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ token, userId })
      });

      const data = await r.json().catch(()=> ({}));

      if(r.ok && data?.valid){
        localStorage.setItem('toolflix_premium_atv','true');
        localStorage.setItem('toolflix_token_ativador', token);
        isPremium = true;

        const premiumXpKey = 'toolflix_premium_xp_once';
        if(localStorage.getItem(premiumXpKey) !== '1'){
          localStorage.setItem(premiumXpKey, '1');
          awardXp(XP_RULES.premium, 'Virou Premium');
        }

        document.getElementById('premiumModal').style.display = 'none';
        showToast("ğŸ’ PREMIUM ATIVADO!");
        await refreshPremiumCount();
        updatePremiumSidebar();
        updateUserUI();
        render();

        document.getElementById('premiumWelcomeModal').style.display = 'flex';
      } else {
        const reason = data?.reason || data?.error || '';
        if(reason === 'TOKEN_EXPIRADO') return showToast("Token expirado!");
        if(reason === 'TOKEN_JA_USADO') return showToast("Token jÃ¡ foi usado!");
        showToast("Token invÃ¡lido!");
      }
    }catch(e){
      console.error(e);
      showToast("Erro ao validar token.");
    }
  });
    /* ===============================
     ADMIN (UI simples + editar/deletar)
  ================================= */

  let editandoNome = null; // vai guardar o LINK antigo do item em ediÃ§Ã£o

  function ensureAdminUI(){
    const admin = document.getElementById('adminSection');
    if(!admin) return;
    if(admin.dataset.ready === '1') return;

    admin.innerHTML = `
      <header style="display:flex; justify-content:space-between; align-items:center; margin-bottom: 25px;">
        <h2 style="color:var(--cor-accent); font-size: 24px;">ğŸš€ Dashboard Admin</h2>
        <button id="exitAdminBtn" class="nav-item" style="background:#ff4757; border:none; color:#fff;">Sair</button>
      </header>

      <div class="admin-grid">
        <input type="text" id="nomeJogo" class="admin-input" placeholder="Nome do TÃ­tulo">
        <input type="text" id="linkCapa" class="admin-input" placeholder="Link da Imagem (URL)">
        <input type="text" id="linkJogo" class="admin-input" placeholder="Link do Download (URL)">
        <select id="selectCategoria" class="admin-input"></select>

        <label class="admin-input" style="display:flex; align-items:center; gap:10px; cursor:pointer;">
          <input type="checkbox" id="isPremiumItem" style="transform: scale(1.2);">
          ğŸ’ Item Premium
        </label>
      </div>

      <div style="display:flex; gap: 12px; margin-bottom: 10px;">
        <button id="addJogoBtn" class="nav-item" style="background:var(--cor-accent); color:#000; border:none; flex: 2; font-size: 16px;">ğŸ’¾ SALVAR CONTEÃšDO</button>
        <button id="exportBackupBtn" class="nav-item" style="background:#2ecc71; color:#000; border:none; flex: 1;">ğŸ“‚ BACKUP</button>
      </div>

      <div style="opacity:.8; font-size:12px; margin-top:8px;">
        Dica: clique em â€œEDITARâ€ em um card pra carregar aqui.
      </div>
    `;

    admin.dataset.ready = '1';

    const sel = document.getElementById('selectCategoria');
    if(sel){
      sel.innerHTML = '';
      document.querySelectorAll('.catBtn').forEach(b=>{
        if(b.dataset.cat && b.dataset.cat !== 'Todos'){
          sel.innerHTML += `<option value="${b.dataset.cat}">${b.dataset.cat}</option>`;
        }
      });
    }

    document.getElementById('exitAdminBtn')?.addEventListener('click', ()=> exitAdmin());

// === AdminKey (salva no navegador pra nÃ£o digitar sempre) ===
const LS_ADMINKEY = "toolflix_admin_key";
function getAdminKey(){
  let k = localStorage.getItem(LS_ADMINKEY) || "";
  if(!k){
    k = prompt("Digite a ADMIN KEY da API:") || "";
    k = k.trim();
    if(k) localStorage.setItem(LS_ADMINKEY, k);
  }
  return k.trim();
}

document.getElementById('addJogoBtn')?.addEventListener('click', async ()=>{
  const n = document.getElementById('nomeJogo');
  const c = document.getElementById('linkCapa');
  const l = document.getElementById('linkJogo');
  const cat = document.getElementById('selectCategoria');
  const chk = document.getElementById('isPremiumItem');

  const nome = (n.value || '').trim();
  const capa = (c.value || '').trim();
  const link = (l.value || '').trim();
  let categoria = (cat.value || '').trim();

  if(!nome || !link) return showToast("Nome e link sÃ£o obrigatÃ³rios!");

  // Premium vai como categoria "Premium" (se marcado)
  

  const adminKey = getAdminKey();
  if(!adminKey) return showToast("Admin Key obrigatÃ³ria!");

  try{
    // Se vocÃª estiver editando e mudou o LINK, apaga o antigo primeiro
    const oldLink = editandoNome || null; // aqui vamos guardar o link antigo no edit (veja ajuste abaixo)
    if(oldLink && oldLink !== link){
      await fetch(`${API_URL}/api/admin/games/delete`, {
        method: "POST",
        headers: { "Content-Type":"application/json", "x-admin-key": adminKey },
        body: JSON.stringify({ link: oldLink })
      });
    }

    const r = await fetch(`${API_URL}/api/admin/games`, {
      method: "POST",
      headers: { "Content-Type":"application/json", "x-admin-key": adminKey },
      body: JSON.stringify({
  title: nome,
  link,
  image: capa,
  category: categoria,
  premium: !!(chk && chk.checked)
})
    });

    const data = await r.json().catch(()=> ({}));
    if(!r.ok || data?.ok !== true){
      console.log(data);
      return showToast("Erro ao salvar na API!");
    }

    showToast("âœ… Salvo na API!");

    // limpa modo ediÃ§Ã£o
    editandoNome = null;
    document.getElementById('addJogoBtn').innerText = "ğŸ’¾ SALVAR CONTEÃšDO";

    n.value = ''; c.value = ''; l.value = '';
    if(chk) chk.checked = false;

    await syncJogos(); // puxa do Render
  }catch(e){
    console.error(e);
    showToast("Erro ao conectar com API.");
  }
});

    document.getElementById('exportBackupBtn')?.addEventListener('click', ()=>{
      const blob = new Blob([JSON.stringify({jogos: db_jogos}, null, 2)], {type:'application/json'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'toolflix_data.json';
      a.click();
    });
  }

  window.editJogo = (nome)=>{
    const j = db_jogos.find(x => x.nome === nome);
    if(!j) return;

    ensureAdminUI();
    document.getElementById('adminSection').style.display = 'block';

    document.getElementById('nomeJogo').value = j.nome || '';
    document.getElementById('linkCapa').value = j.capa || '';
    document.getElementById('linkJogo').value = j.link || '';
    document.getElementById('selectCategoria').value = j.categoria || 'Jogos PS2';

    const chk = document.getElementById('isPremiumItem');
    if(chk) chk.checked = !!j.premium;

    document.getElementById('addJogoBtn').innerText = "ğŸ†™ ATUALIZAR ITEM";
    editandoNome = nome;

    window.scrollTo({top: 0, behavior: 'smooth'});
  };

  window.delJogo = async (nome)=>{
  const j = db_jogos.find(x => x.nome === nome);
  if(!j) return;

  if(!confirm("Deseja mesmo excluir este conteÃºdo?")) return;

  const adminKey = (localStorage.getItem("toolflix_admin_key") || "").trim() || (prompt("Digite a ADMIN KEY da API:") || "").trim();
  if(!adminKey) return showToast("Admin Key obrigatÃ³ria!");
  localStorage.setItem("toolflix_admin_key", adminKey);

  try{
    const r = await fetch(`${API_URL}/api/admin/games/delete`, {
      method: "POST",
      headers: { "Content-Type":"application/json", "x-admin-key": adminKey },
      body: JSON.stringify({ link: j.link })
    });
    const data = await r.json().catch(()=> ({}));
    if(!r.ok || data?.ok !== true){
      console.log(data);
      return showToast("Erro ao deletar na API!");
    }

    showToast("ğŸ—‘ï¸ Deletado na API!");
    await syncJogos();
  }catch(e){
    console.error(e);
    showToast("Erro ao conectar com API.");
  }
};

  function exitAdmin(){
    modoAdmin = false;
    const admin = document.getElementById('adminSection');
    if(admin) admin.style.display = 'none';
    showToast("Modo Admin desativado.");
    render();
  }

  document.getElementById('adminBtn')?.addEventListener('click', (e)=>{
    e.preventDefault();
    e.stopPropagation();
    document.getElementById('loginModal').style.display = 'flex';
    document.getElementById('loginInput')?.focus();
  });

  document.getElementById('loginSubmit')?.addEventListener('click', ()=>{
    const pass = document.getElementById('loginInput')?.value || '';
    if(pass === '@dm1nt1'){
      modoAdmin = true;
      document.getElementById('loginModal').style.display = 'none';
      const admin = document.getElementById('adminSection');
      if(admin) admin.style.display = 'block';
      ensureAdminUI();
      showToast("âœ… Modo Admin ativado!");
      render();
    }else{
      showToast("Senha incorreta!");
    }
  });

  document.getElementById('loginInput')?.addEventListener('keydown', (e)=>{
    if(e.key === 'Enter'){ e.preventDefault(); document.getElementById('loginSubmit')?.click(); }
  });

  /* ===============================
     SUPORTE
  ================================= */

  function toggleSuporte(){
    document.getElementById('suporteContainer')?.classList.toggle('ativo');
  }
  document.getElementById('suporteBtn')?.addEventListener('click', toggleSuporte);
  document.getElementById('suporteClose')?.addEventListener('click', toggleSuporte);

  /* ===============================
     ESC fecha modais
  ================================= */

  window.addEventListener('keydown', (e)=>{
    if(e.key === 'Escape'){
      document.querySelectorAll('.modal-overlay').forEach(m => m.style.display = 'none');
      toggleUserMenu(true);
      if(modoAdmin) exitAdmin();
    }
  });

  /* ===============================
     INIT
  ================================= */

  updateUserUI();
  updatePremiumSidebar();
  render();

  checkPremiumSync();
  syncJogos();

  setInterval(syncJogos, 60 * 1000);
  setInterval(checkPremiumSync, 3 * 60 * 1000);
    </script>
</body>
</html>