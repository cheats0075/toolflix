<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ToolFlix Pro - Oficial</title>
    <style>
        :root {
            --cor-accent: #00ffff;
            --cor-bg-overlay: rgba(0, 0, 0, 0.7);
            --glass-bg: rgba(15, 15, 15, 0.98);
            --glass-border: rgba(255, 255, 255, 0.1);
            --sidebar-width: 280px;
        }
        /* --- TEMAS --- */
        body.theme-gow { --cor-accent: #0077ff; background-image: linear-gradient(var(--cor-bg-overlay), var(--cor-bg-overlay)), url('https://cdna.artstation.com/p/assets/covers/images/013/652/970/large/sm-bonin-athena-19.jpg?1540572163') !important; }
        body.theme-dbz { --cor-accent: #ff8c00; background-image: linear-gradient(var(--cor-bg-overlay), var(--cor-bg-overlay)), url('https://m.media-amazon.com/images/I/714yiDPJ7wL.jpg') !important; }
        body.theme-mk { --cor-accent: #ff0000; background-image: linear-gradient(var(--cor-bg-overlay), var(--cor-bg-overlay)), url('https://i.redd.it/he010ipc19p51.jpg') !important; }
        body.theme-gta { --cor-accent: #2ecc71; background-image: linear-gradient(var(--cor-bg-overlay), var(--cor-bg-overlay)), url('https://wallpapers.com/images/hd/gta-sa-4k-blonde-girl-z9zaoylvpq1ly51q.jpg') !important; }
        body.theme-gtav { --cor-accent: #fbc531; background-image: linear-gradient(var(--cor-bg-overlay), var(--cor-bg-overlay)), url('https://www.menosfios.com/wp-content/uploads/2013/12/gta5.jpg') !important; }
        body.theme-cod { --cor-accent: #7dff00; background-image: linear-gradient(var(--cor-bg-overlay), var(--cor-bg-overlay)), url('https://images7.alphacoders.com/605/605587.jpg') !important; }
        body.theme-re { --cor-accent: #ff0055; background-image: linear-gradient(var(--cor-bg-overlay), var(--cor-bg-overlay)), url('https://wallpapers.com/images/hd/resident-evil-4-remake-leon-sk9m6v4n37160y7g.jpg') !important; }

        * { margin:0; padding:0; box-sizing:border-box; }
        body { font-family:'Segoe UI', sans-serif; background:#0a0a0a; color:#f0f0f0; display: flex; min-height: 100vh; background-attachment: fixed; background-size: cover; background-position: center; transition: 0.5s; overflow-x: hidden; }
        
        .sidebar { width: var(--sidebar-width); height: 100vh; background: rgba(5, 5, 5, 0.95); backdrop-filter: blur(40px); border-right: 1px solid var(--glass-border); position: fixed; left: 0; top: 0; display: flex; flex-direction: column; padding: 20px; z-index: 1000; }
        #logoToolFlix { font-family:'Impact', sans-serif; font-size:35px; background:linear-gradient(90deg,#fff, var(--cor-accent)); -webkit-background-clip:text; -webkit-text-fill-color:transparent; margin-bottom: 25px; cursor: pointer; text-align: center; letter-spacing: 2px; }
        
        .catBtn { background: rgba(255,255,255,0.03); color: #aaa; padding: 12px 18px; border-radius: 14px; margin-bottom: 5px; font-weight: 500; cursor: pointer; border: 1px solid transparent; text-align: left; transition: 0.3s; font-size: 14px; display: flex; align-items: center; gap: 10px; }
        .catBtn:hover { background: rgba(255,255,255,0.08); color: #fff; transform: translateX(5px); }
        .catBtn.active { background: linear-gradient(135deg, var(--cor-accent), #008080); color: #000 !important; font-weight: 800; }
        
        #premiumTriggerBtn { background: gold; color: #000; border: none; font-weight: 900; animation: pulsePremium 2s infinite; box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.7); }
        #solicitarTokenBtn { background: #f1c40f; color: #000; border: none; font-weight: 800; margin-top: 5px; }
        
        @keyframes pulsePremium { 0% { transform: scale(1); } 70% { transform: scale(1.05); box-shadow: 0 0 0 15px rgba(255, 215, 0, 0); } 100% { transform: scale(1); } }
        
        main { margin-left: var(--sidebar-width); flex: 1; padding: 25px 40px; width: calc(100% - var(--sidebar-width)); }
        .top-nav { display: flex; justify-content: flex-end; align-items: center; gap: 12px; margin-bottom: 35px; }
        .nav-item { background: rgba(255,255,255,0.05); border: 1px solid var(--glass-border); color: #fff; padding: 10px 18px; border-radius: 50px; cursor: pointer; font-weight: 600; transition: 0.3s; font-size: 13px; outline: none; }
        
        #themeSelect { background: #1a1a1a; color: gold; border: 1px solid gold; padding: 10px 15px; cursor: pointer; border-radius: 12px; font-weight: bold; }
        
        #catalogo { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 30px; }
        .jogo { background: var(--glass-bg); border-radius: 18px; padding: 14px; border: 1px solid var(--glass-border); position: relative; transition: 0.4s; cursor: pointer; overflow: hidden; }
        .jogo img { width: 100%; border-radius: 12px; aspect-ratio: 1/1; object-fit: cover; display: block; }
        
        .jogo-premium { border: 2px solid gold !important; animation: glowPremium 3s infinite ease-in-out; }
        @keyframes glowPremium { 0%, 100% { box-shadow: 0 0 5px gold; } 50% { box-shadow: 0 0 20px gold; } }
        
        .premium-locked img { filter: grayscale(100%) blur(5px); opacity: 0.3; }
        .lock-icon { position: absolute; top: 40%; left: 50%; transform: translate(-50%, -50%); font-size: 40px; color: gold; z-index: 5; }
        
        .modal-overlay { position:fixed; inset:0; background:rgba(0,0,0,0.9); backdrop-filter:blur(20px); display:none; justify-content:center; align-items:center; z-index:9999; }
        .modal-box { background: linear-gradient(145deg, #1a1a1a, #0a0a0a); padding: 40px; border-radius: 35px; width: 380px; text-align: center; border: 1px solid var(--glass-border); }
        .modal-box input { width: 100%; padding: 16px; margin-bottom: 20px; background: rgba(255,255,255,0.05); border: 1px solid #333; border-radius: 18px; color: #fff; text-align: center; font-size: 18px; }
        .btn-modal { width: 100%; padding: 16px; border-radius: 18px; border: none; font-weight: 800; cursor: pointer; }

        #adminSection { display:none; background: var(--glass-bg); padding:25px; border-radius:20px; border: 2px solid var(--cor-accent); margin-bottom: 30px; }
        #toast-container { position: fixed; bottom: 20px; right: 20px; z-index: 10000; }
        .toast { background: rgba(20,20,20,0.95); color: #fff; padding: 15px 30px; border-radius: 12px; margin-top: 10px; border-left: 5px solid var(--cor-accent); }
    </style>
</head>
<body class="theme-default">

<aside class="sidebar">
    <div id="logoToolFlix" onclick="location.reload()">ToolFlix</div>
    <div style="margin-bottom:20px">
        <input type="text" id="searchBar" placeholder="ğŸ” Buscar..." style="width:100%; padding:12px; border-radius:12px; border:1px solid #333; background:rgba(255,255,255,0.05); color:#fff; outline:none">
    </div>
    <nav id="categoriaBtns">
        <button class="catBtn active" data-cat="Todos">ğŸ“‚ Todos</button>
        <button class="catBtn" data-cat="Jogos PS2">ğŸ® Jogos PS2</button>
        <button class="catBtn" data-cat="PS2 com Cheats">ğŸ”¥ PS2 Cheats</button>
        <button class="catBtn" data-cat="Jogos PS3">ğŸ® Jogos PS3</button>
        <button class="catBtn" data-cat="PS3 com Cheats">ğŸ”¥ PS3 Cheats</button>
        <button class="catBtn" data-cat="Jogos PS1">ğŸ® Jogos PS1</button>
        <button class="catBtn" data-cat="PS1 com Cheats">ğŸ”¥ PS1 Cheats</button>
        <button class="catBtn" data-cat="YouTube">ğŸ“º YouTube</button>
        <button class="catBtn" data-cat="Jogos PC">ğŸ’» Jogos PC</button>
        <button class="catBtn" data-cat="Fix SteamTools">ğŸ› ï¸ SteamTools</button>
        <button class="catBtn" data-cat="Arquivos">ğŸ“ Arquivos</button>
        <button class="catBtn" data-cat="Roms">ğŸ“€ Roms</button>
        <button class="catBtn" data-cat="Emuladores">ğŸ•¹ï¸ Emuladores</button>
        <button class="catBtn" data-cat="Premium" id="catPremiumBtn" style="border: 1px dashed gold; color: gold !important;">ğŸ’ Premium ğŸ”’</button>
    </nav>
</aside>

<main>
    <div class="top-nav">
        <select id="themeSelect" class="nav-item">
            <option value="default">ğŸ­ PadrÃ£o</option>
            <option value="gow">âš”ï¸ God of War</option>
            <option value="dbz">ğŸ’ DBZ</option>
            <option value="mk">ğŸ’ MK</option>
            <option value="gta">ğŸ’ GTA SA</option>
            <option value="gtav">ğŸ’ GTA V</option>
            <option value="cod">ğŸ’ COD</option>
            <option value="re">ğŸ’ Resident Evil</option>
        </select>
        <button class="nav-item" id="sortBtn">ğŸ”ƒ Ordem: Recentes</button>
        <button class="nav-item" id="favFiltroBtn">â¤ï¸ Favoritos</button>
        <button class="nav-item" id="adminBtn">âš™ï¸ Admin</button>
        <div style="display: flex; flex-direction: column; gap: 5px;">
            <button class="nav-item" id="premiumTriggerBtn">ğŸ’ ATIVAR PREMIUM</button>
            <button class="nav-item" id="solicitarTokenBtn" onclick="window.open('https://www.youtube.com/watch?v=FbHaSemn5NI', '_blank')">ğŸ SOLICITAR TOKEN GRÃTIS</button>
        </div>
    </div>

    <section id="adminSection">
        <h3 style="color:var(--cor-accent); margin-bottom:15px">Painel Admin</h3>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap:10px; margin-bottom: 20px;">
            <input type="text" id="nomeJogo" placeholder="Nome">
            <input type="text" id="linkCapa" placeholder="URL Capa">
            <input type="text" id="linkJogo" placeholder="URL Download">
            <select id="selectCategoria"></select>
            <button id="addJogoBtn" class="nav-item" style="background:var(--cor-accent); color:#000; border:none;">SALVAR ITEM</button>
            <button id="exportBackupBtn" class="nav-item" style="background:#2ecc71; color:#000; border:none;">BACKUP JOGOS</button>
        </div>
        
        <div style="background: rgba(255,255,255,0.03); padding: 15px; border-radius: 15px; border: 1px solid #333;">
            <h4 style="color:gold; margin-bottom:10px">GestÃ£o de Tokens</h4>
            <div style="display:grid; grid-template-columns: repeat(4, 1fr); gap:10px; margin-bottom:10px">
                <button id="genTokenBtn" class="nav-item" style="color:gold; border-color:gold">GERAR</button>
                <button id="exportTokensBtn" class="nav-item">EXPORTAR</button>
                <button id="importTokensBtn" class="nav-item">IMPORTAR</button>
                <button id="clearUsedBtn" class="nav-item" style="background:#ff4757; border:none">LIMPAR</button>
            </div>
            <div id="tokenList" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(110px, 1fr)); gap: 8px; max-height: 150px; overflow-y: auto;"></div>
            <input type="file" id="fileInput" style="display:none" accept=".json">
        </div>
    </section>

    <h2 id="sectionTitle" style="margin-bottom:25px;">Todos</h2>
    <section id="catalogo"></section>
</main>

<div id="loginModal" class="modal-overlay">
    <div class="modal-box">
        <h4>ADMIN</h4>
        <input type="password" id="loginInput" placeholder="Senha">
        <button id="loginSubmit" class="btn-modal" style="background:var(--cor-accent)">Entrar</button>
    </div>
</div>

<div id="premiumModal" class="modal-overlay">
    <div class="modal-box">
        <h4 style="color:gold">ATIVAR PREMIUM</h4>
        <input type="text" id="premiumInput" maxlength="6" placeholder="DIGITE O TOKEN">
        <button id="premiumSubmit" class="btn-modal" style="background:gold">Validar</button>
    </div>
</div>

<div id="toast-container"></div>

<script>
(function(){
    // USANDO LINK RAW PARA FURAR O CACHE DO JSDELIVR
    const URL_TOKENS = "https://raw.githubusercontent.com/cheats0075/toolflix/main/tokens.json";
    const URL_JOGOS = "https://cdn.jsdelivr.net/gh/cheats0075/toolflix@latest/toolflix_backup.json";

    let db_jogos = JSON.parse(localStorage.getItem('jogosPS2')) || [];
    let db_favs = JSON.parse(localStorage.getItem('toolflix_favs')) || [];
    let db_tokens_ativos = JSON.parse(localStorage.getItem('toolflix_tokens_atv')) || [];
    let db_tokens_usados = JSON.parse(localStorage.getItem('toolflix_tokens_usd')) || [];
    
    let isPremium = false; // ComeÃ§a como falso atÃ© validar
    let modoAdmin = false;
    let catAtiva = 'Todos';
    let sortModo = 'recentes';
    let filterFav = false;
    let editandoIndex = -1;
    let currentTheme = 'default';

    // --- 1. VERIFICAÃ‡ÃƒO DE ASSINATURA (O SEGREDO DO BLOQUEIO) ---
    async function checkPremiumSync() {
        const tokenAtivador = localStorage.getItem('toolflix_token_ativador');
        
        if (!tokenAtivador) {
            isPremium = false;
            render();
            return;
        }

        try {
            // Timestamp para ignorar cache (?t=...)
            const resp = await fetch(URL_TOKENS + '?t=' + new Date().getTime());
            if (resp.ok) {
                const data = await resp.resp ? await resp.json() : JSON.parse(await resp.text());
                const ativos = data.ativos || [];
                const usados = data.usados || [];

                // SE O TOKEN FOI BANIDO (USADOS) OU NÃƒO EXISTE MAIS (REMOVIDO DOS ATIVOS)
                if (usados.includes(tokenAtivador) || !ativos.includes(tokenAtivador)) {
                    localStorage.removeItem('toolflix_premium_atv');
                    localStorage.removeItem('toolflix_token_ativador');
                    isPremium = false;
                    showToast("âŒ Token expirado ou banido!");
                } else {
                    isPremium = true;
                }
                render();
            }
        } catch (e) {
            // Em caso de erro de rede, mantemos o local mas tentamos de novo depois
            isPremium = localStorage.getItem('toolflix_premium_atv') === 'true';
            render();
        }
    }

    async function syncJogos() {
        try {
            const response = await fetch(URL_JOGOS + '?t=' + new Date().getTime());
            if (response.ok) {
                const data = await response.json();
                db_jogos = data.jogos || data;
                localStorage.setItem('jogosPS2', JSON.stringify(db_jogos));
                render();
            }
        } catch (e) { console.error(e); }
    }

    function showToast(msg) {
        const t = document.createElement('div'); t.className = 'toast'; t.innerText = msg;
        document.getElementById('toast-container').appendChild(t);
        setTimeout(() => { t.style.opacity = '0'; setTimeout(() => t.remove(), 300); }, 4000);
    }

    function render() {
        const grid = document.getElementById('catalogo'); grid.innerHTML = '';
        const btnP = document.getElementById('premiumTriggerBtn');
        const btnS = document.getElementById('solicitarTokenBtn');
        const catP = document.getElementById('catPremiumBtn');

        if(isPremium) {
            catP.innerHTML = "ğŸ’ Premium ğŸ”“";
            btnP.style.display = 'none';
            btnS.style.display = 'none';
        } else {
            catP.innerHTML = "ğŸ’ Premium ğŸ”’";
            btnP.style.display = 'block';
            btnS.style.display = 'block';
        }

        let lista = [...db_jogos];
        if(catAtiva !== 'Todos') lista = lista.filter(j => j.categoria === catAtiva);
        const search = document.getElementById('searchBar').value.toLowerCase();
        if(search) lista = lista.filter(j => j.nome.toLowerCase().includes(search));
        if(filterFav) lista = lista.filter(j => db_favs.includes(j.nome));
        if(sortModo === 'az') lista.sort((a,b) => a.nome.localeCompare(b.nome));
        else if(sortModo === 'recentes') lista.reverse();

        lista.forEach((j) => {
            const isF = db_favs.includes(j.nome);
            const isP = j.categoria === 'Premium';
            const lock = isP && !isPremium && !modoAdmin;
            const card = document.createElement('div');
            card.className = `jogo ${isP ? 'jogo-premium' : ''} ${lock ? 'premium-locked' : ''}`;
            
            card.onclick = () => { 
                if(lock) { showToast("ğŸ”’ ConteÃºdo Premium!"); } 
                else { window.open(j.link, '_blank'); } 
            };

            card.innerHTML = `
                <button onclick="event.stopPropagation(); window.toggleFav('${j.nome}')" style="position:absolute; top:12px; right:12px; background:rgba(0,0,0,0.6); color:${isF?'#ff4757':'#fff'}; border:none; width:30px; height:30px; border-radius:50%; cursor:pointer; z-index:10;">${isF?'â¤ï¸':'ğŸ¤'}</button>
                ${lock ? '<span class="lock-icon">ğŸ”’</span>' : ''}
                <img src="${j.capa}">
                <div style="text-align:center">
                    <span style="font-size:10px; color:var(--cor-accent)">${j.categoria}</span>
                    <p style="font-weight:700; font-size:13px; margin-top:5px">${j.nome}</p>
                </div>
                ${modoAdmin ? `<button onclick="event.stopPropagation(); window.delJogo('${j.nome}')" style="width:100%; margin-top:10px; background:#ff4757; color:#fff; border:none; padding:5px; border-radius:5px">EXCLUIR</button>` : ''}
            `;
            grid.appendChild(card);
        });
        renderTokenList();
    }

    // --- TOKENS ADMIN ---
    function renderTokenList() {
        const div = document.getElementById('tokenList'); div.innerHTML = '';
        db_tokens_ativos.forEach((t, i) => {
            div.innerHTML += `<div style="background:#003300; color:#00ff00; padding:5px; border-radius:5px; font-size:10px; display:flex; justify-content:space-between"><span>âœ… ${t}</span> <b onclick="desativarToken(${i})" style="cursor:pointer; color:#ff4757">X</b></div>`;
        });
        db_tokens_usados.forEach((t) => {
            div.innerHTML += `<div style="background:#330000; color:#ff4757; padding:5px; border-radius:5px; font-size:10px; opacity:0.6">ğŸš« ${t}</div>`;
        });
    }

    window.desativarToken = (i) => {
        const t = db_tokens_ativos.splice(i,1)[0];
        if(!db_tokens_usados.includes(t)) db_tokens_usados.push(t);
        saveTokensLocal(); render();
    };

    function saveTokensLocal() {
        localStorage.setItem('toolflix_tokens_atv', JSON.stringify(db_tokens_ativos));
        localStorage.setItem('toolflix_tokens_usd', JSON.stringify(db_tokens_usados));
    }

    document.getElementById('genTokenBtn').onclick = () => {
        const r = Math.random().toString(36).substring(2,8).toUpperCase();
        db_tokens_ativos.push(r); saveTokensLocal(); render();
    };

    // --- VALIDAÃ‡ÃƒO PREMIUM ---
    async function validatePremium() {
        const input = document.getElementById('premiumInput').value.toUpperCase().trim();
        if(!input) return;

        showToast("Validando...");
        try {
            const resp = await fetch(URL_TOKENS + '?t=' + new Date().getTime());
            const data = await resp.json();
            const ativos = data.ativos || [];

            if(ativos.includes(input)) {
                localStorage.setItem('toolflix_premium_atv', 'true');
                localStorage.setItem('toolflix_token_ativador', input);
                isPremium = true;
                document.getElementById('premiumModal').style.display = 'none';
                render();
                showToast("ğŸ’ Premium Ativado!");
            } else {
                showToast("âŒ Token invÃ¡lido!");
            }
        } catch (e) { showToast("Erro de conexÃ£o"); }
    }

    // --- EVENTOS ---
    document.getElementById('premiumSubmit').onclick = validatePremium;
    document.getElementById('premiumTriggerBtn').onclick = () => document.getElementById('premiumModal').style.display='flex';
    document.getElementById('adminBtn').onclick = () => document.getElementById('loginModal').style.display='flex';
    document.getElementById('loginSubmit').onclick = () => {
        if(document.getElementById('loginInput').value === '@dm1nt1') {
            modoAdmin = true; document.getElementById('loginModal').style.display='none';
            document.getElementById('adminSection').style.display='block';
            const sel = document.getElementById('selectCategoria'); sel.innerHTML = '';
            document.querySelectorAll('.catBtn').forEach(b => { if(b.dataset.cat !== 'Todos') sel.innerHTML += `<option value="${b.dataset.cat}">${b.dataset.cat}</option>`; });
            render();
        }
    };

    document.getElementById('addJogoBtn').onclick = () => {
        const n=document.getElementById('nomeJogo').value, c=document.getElementById('linkCapa').value, l=document.getElementById('linkJogo').value, cat=document.getElementById('selectCategoria').value;
        if(n) { db_jogos.push({nome:n, capa:c, link:l, categoria:cat}); localStorage.setItem('jogosPS2', JSON.stringify(db_jogos)); render(); }
    };

    document.getElementById('exportBackupBtn').onclick = () => {
        const blob = new Blob([JSON.stringify({jogos: db_jogos})], {type:'application/json'});
        const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'toolflix_backup.json'; a.click();
    };

    document.getElementById('exportTokensBtn').onclick = () => {
        const blob = new Blob([JSON.stringify({ativos: db_tokens_ativos, usados: db_tokens_usados})], {type:'application/json'});
        const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'tokens.json'; a.click();
    };

    document.getElementById('importTokensBtn').onclick = () => document.getElementById('fileInput').click();
    document.getElementById('fileInput').onchange = (e) => {
        const fr = new FileReader();
        fr.onload = (ev) => {
            const data = JSON.parse(ev.target.result);
            db_tokens_ativos = data.ativos || []; db_tokens_usados = data.usados || [];
            saveTokensLocal(); render();
        };
        fr.readAsText(e.target.files[0]);
    };

    document.querySelectorAll('.catBtn').forEach(b => {
        b.onclick = () => {
            document.querySelector('.catBtn.active').classList.remove('active');
            b.classList.add('active'); catAtiva = b.dataset.cat;
            document.getElementById('sectionTitle').innerText = catAtiva; render();
        };
    });

    document.getElementById('themeSelect').onchange = (e) => {
        document.body.className = 'theme-' + e.target.value;
    };

    window.toggleFav = (n) => {
        const i = db_favs.indexOf(n);
        if(i > -1) db_favs.splice(i,1); else db_favs.push(n);
        localStorage.setItem('toolflix_favs', JSON.stringify(db_favs)); render();
    };

    window.delJogo = (nome) => {
        db_jogos = db_jogos.filter(j => j.nome !== nome);
        localStorage.setItem('jogosPS2', JSON.stringify(db_jogos)); render();
    };

    // INICIALIZAÃ‡ÃƒO
    checkPremiumSync();
    syncJogos();
})();
</script>
</body>
</html>